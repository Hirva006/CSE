<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Travelo — Flights</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    .flight-card {
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .flight-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    .pulse {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: .5; }
    }
  </style>
</head>

<body class="bg-gray-50 text-gray-800">

  <!-- HEADER -->
  <header class="bg-white shadow transition-colors duration-300">
    <div class="container mx-auto px-6 py-4 flex items-center justify-between">
      <a href="index.html" class="text-2xl font-bold text-indigo-600">Travelo</a>
      <nav class="hidden md:flex gap-6 items-center">
        <a href="index.html" class="hover:text-indigo-600">Home</a>
        <a href="flights.html" class="hover:text-indigo-600">Flights</a>
        <a href="hotels.html" class="hover:text-indigo-600">Hotels</a>
        <a href="packages.html" class="hover:text-indigo-600">Packages</a>
        <a href="contact.html" class="hover:text-indigo-600">Contact</a>
      </nav>
      <div class="flex items-center gap-4">
        <button id="themeToggle"
          class="p-2 rounded-lg hover:bg-gray-100 transition-colors duration-200 flex items-center justify-center"
          aria-label="Toggle dark mode">
          <svg id="sunIcon" class="w-5 h-5 text-gray-800 transition-colors duration-200" fill="currentColor"
            viewBox="0 0 20 20">
            <path fill-rule="evenodd"
              d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
              clip-rule="evenodd"></path>
          </svg>
          <svg id="moonIcon" class="w-5 h-5 text-gray-800 hidden transition-colors duration-200" fill="currentColor"
            viewBox="0 0 20 20">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
          </svg>
        </button>
        <a href="admin/login.html"
          class="text-sm px-3 py-2 rounded border border-indigo-600 text-indigo-600 hover:bg-indigo-50">Admin</a>
        <button id="mobileMenuBtn" class="md:hidden p-2 rounded bg-gray-100">☰</button>
      </div>
    </div>
    <!-- Mobile menu -->
    <div id="mobileMenu" class="hidden md:hidden bg-white border-t transition-colors duration-300">
      <div class="px-6 py-3 flex flex-col gap-2">
        <a href="index.html">Home</a>
        <a href="flights.html">Flights</a>
        <a href="hotels.html">Hotels</a>
        <a href="packages.html">Packages</a>
        <a href="contact.html">Contact</a>
      </div>
    </div>
  </header>

  <!-- Flights Search -->
  <main class="container mx-auto px-6 py-10">
    <h1 class="text-3xl font-bold mb-6">Search Flights</h1>

    <form id="flightSearchForm" class="bg-white p-6 rounded shadow grid grid-cols-1 md:grid-cols-3 gap-4">
      <input name="from" id="fromInput" placeholder="From (City or Airport)" class="p-3 border rounded" required>
      <input name="to" id="toInput" placeholder="To (City or Airport)" class="p-3 border rounded" required>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-2">
        <input name="depart" id="departInput" type="date" class="p-3 border rounded" required>
        <input name="return" id="returnInput" type="date" class="p-3 border rounded">
        <select name="passengers" id="passengersInput" class="p-3 border rounded">
          <option value="1">1 Passenger</option>
          <option value="2">2 Passengers</option>
          <option value="3">3 Passengers</option>
          <option value="4">4 Passengers</option>
        </select>
      </div>
      <div class="md:col-span-3 mt-2">
        <button type="submit" class="px-6 py-3 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition">Search Flights</button>
      </div>
    </form>

    <!-- Results -->
    <section class="mt-8">
      <h2 class="text-xl font-semibold mb-4">Search Results</h2>
      
      <!-- Loading Indicator -->
      <div id="loadingIndicator" class="hidden text-center py-12">
        <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"></div>
        <p class="mt-4 text-gray-600">Searching for flights...</p>
      </div>

      <!-- Flight Results Container -->
      <div id="flightResults" class="space-y-4">
        <!-- Initial sample flights -->
        <div class="flight-card bg-white p-4 rounded shadow flex flex-col md:flex-row justify-between items-center">
          <div>
            <div class="font-semibold text-gray-900">Air India</div>
            <div class="text-sm text-gray-600">08:00 AM — 11:30 AM</div>
            <div class="text-sm text-gray-500">Non-stop</div>
          </div>
          <div class="text-right">
            <div class="text-lg font-bold">₹6,500</div>
            <button class="book-btn mt-2 inline-block px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition" 
                    data-airline="Air India" 
                    data-time="08:00 AM — 11:30 AM" 
                    data-price="6500"
                    data-stops="Non-stop">Book Now</button>
          </div>
        </div>

        <div class="flight-card bg-white p-4 rounded shadow flex flex-col md:flex-row justify-between items-center">
          <div>
            <div class="font-semibold text-gray-900">IndiGo</div>
            <div class="text-sm text-gray-600">02:00 PM — 05:30 PM</div>
            <div class="text-sm text-gray-500">1 stop</div>
          </div>
          <div class="text-right">
            <div class="text-lg font-bold">₹5,200</div>
            <button class="book-btn mt-2 inline-block px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition"
                    data-airline="IndiGo" 
                    data-time="02:00 PM — 05:30 PM" 
                    data-price="5200"
                    data-stops="1 stop">Book Now</button>
          </div>
        </div>
      </div>

      <!-- No Results Message -->
      <div id="noResults" class="hidden text-center py-12">
        <svg class="mx-auto h-16 w-16 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <p class="text-gray-600 text-lg">No flights found for your search criteria.</p>
        <p class="text-gray-500 text-sm mt-2">Try adjusting your dates or destinations.</p>
      </div>
    </section>
  </main>

  <!-- Booking Modal -->
  <div id="bookingModal" class="modal fade" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-indigo-600 text-white">
          <h5 class="modal-title">✈️ Complete Your Booking</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <!-- Flight Details -->
          <div class="mb-4 p-4 bg-indigo-50 rounded-lg border border-indigo-200">
            <h6 class="font-semibold mb-3 text-indigo-900">Flight Details</h6>
            <div class="space-y-2 text-sm">
              <div class="flex justify-between">
                <span class="text-gray-600">Airline:</span>
                <span class="font-medium" id="modalAirline"></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Time:</span>
                <span class="font-medium" id="modalTime"></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Stops:</span>
                <span class="font-medium" id="modalStops"></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Route:</span>
                <span class="font-medium" id="modalRoute"></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Date:</span>
                <span class="font-medium" id="modalDate"></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Passengers:</span>
                <span class="font-medium" id="modalPassengers"></span>
              </div>
              <hr class="my-2">
              <div class="flex justify-between text-lg">
                <span class="font-bold text-gray-800">Total Price:</span>
                <span class="font-bold text-indigo-600" id="modalPrice"></span>
              </div>
            </div>
          </div>

          <!-- Passenger Information Form -->
          <form id="passengerForm">
            <h6 class="font-semibold mb-3">Passenger Information</h6>
            <div class="mb-3">
              <label class="form-label text-sm">Full Name *</label>
              <input type="text" class="form-control" id="passengerName" placeholder="Enter full name as per ID" required>
            </div>
            <div class="mb-3">
              <label class="form-label text-sm">Email *</label>
              <input type="email" class="form-control" id="passengerEmail" placeholder="your@email.com" required>
            </div>
            <div class="mb-3">
              <label class="form-label text-sm">Phone Number *</label>
              <input type="tel" class="form-control" id="passengerPhone" placeholder="+91 XXXXX XXXXX" required>
            </div>
            <div class="mb-3">
              <label class="form-label text-sm">ID Proof Number *</label>
              <input type="text" class="form-control" id="passengerID" placeholder="Passport/Aadhar Number" required>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary bg-indigo-600 border-indigo-600" id="confirmBookingBtn">
            <span id="confirmBtnText">Proceed to Payment</span>
            <span id="confirmBtnLoader" class="hidden">
              <span class="spinner-border spinner-border-sm me-2" role="status"></span>
              Processing...
            </span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-white border-t mt-12">
    <div class="container mx-auto px-6 py-8 grid grid-cols-1 md:grid-cols-3 gap-6">
      <div>
        <h4 class="font-bold text-indigo-600">Travelo</h4>
        <p class="text-sm text-gray-600 mt-2">Explore. Plan. Book.</p>
      </div>
      <div>
        <h5 class="font-semibold">Quick Links</h5>
        <ul class="mt-2 space-y-1 text-sm">
          <li><a href="flights.html" class="hover:text-indigo-600">Flights</a></li>
          <li><a href="hotels.html" class="hover:text-indigo-600">Hotels</a></li>
          <li><a href="packages.html" class="hover:text-indigo-600">Packages</a></li>
        </ul>
      </div>
      <div>
        <h5 class="font-semibold">Contact</h5>
        <p class="text-sm mt-2">support@travelo.example<br />+1 234 567 890</p>
      </div>
    </div>
    <div class="text-center text-sm py-4 border-t bg-gray-50">© Travelo</div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/script.js"></script>
  <script>
    // Flight database with various airlines and routes
    const flightDatabase = [
      { airline: "Air India", time: "06:00 AM — 09:30 AM", stops: "Non-stop", basePrice: 6500, duration: "3h 30m" },
      { airline: "Air India", time: "08:00 AM — 11:30 AM", stops: "Non-stop", basePrice: 6500, duration: "3h 30m" },
      { airline: "IndiGo", time: "07:30 AM — 11:00 AM", stops: "Non-stop", basePrice: 5800, duration: "3h 30m" },
      { airline: "IndiGo", time: "02:00 PM — 05:30 PM", stops: "1 stop", basePrice: 5200, duration: "3h 30m" },
      { airline: "IndiGo", time: "09:00 PM — 12:30 AM", stops: "Non-stop", basePrice: 6200, duration: "3h 30m" },
      { airline: "SpiceJet", time: "06:30 AM — 10:00 AM", stops: "Non-stop", basePrice: 5800, duration: "3h 30m" },
      { airline: "SpiceJet", time: "03:00 PM — 07:00 PM", stops: "1 stop", basePrice: 4800, duration: "4h" },
      { airline: "Vistara", time: "12:00 PM — 03:45 PM", stops: "Non-stop", basePrice: 7200, duration: "3h 45m" },
      { airline: "Vistara", time: "05:00 PM — 08:30 PM", stops: "Non-stop", basePrice: 7500, duration: "3h 30m" },
      { airline: "Go First", time: "04:00 PM — 08:30 PM", stops: "1 stop", basePrice: 4900, duration: "4h 30m" },
      { airline: "Go First", time: "11:30 AM — 03:00 PM", stops: "Non-stop", basePrice: 5600, duration: "3h 30m" },
      { airline: "AirAsia", time: "09:30 AM — 01:00 PM", stops: "1 stop", basePrice: 4700, duration: "3h 30m" },
      { airline: "AirAsia", time: "01:00 PM — 04:30 PM", stops: "Non-stop", basePrice: 5300, duration: "3h 30m" },
      { airline: "Air India Express", time: "07:00 PM — 10:30 PM", stops: "Non-stop", basePrice: 6100, duration: "3h 30m" },
      { airline: "Air India Express", time: "10:30 AM — 02:00 PM", stops: "Non-stop", basePrice: 6300, duration: "3h 30m" }
    ];

    let currentSearchData = {};
    let selectedFlight = {};

    // Flight search form submission
    document.getElementById('flightSearchForm').addEventListener('submit', (e) => {
      e.preventDefault();
      
      const from = document.getElementById('fromInput').value.trim();
      const to = document.getElementById('toInput').value.trim();
      const depart = document.getElementById('departInput').value;
      const returnDate = document.getElementById('returnInput').value;
      const passengers = document.getElementById('passengersInput').value;

      // Store search data
      currentSearchData = { from, to, depart, returnDate, passengers };

      // Show loading state
      document.getElementById('loadingIndicator').classList.remove('hidden');
      document.getElementById('flightResults').classList.add('hidden');
      document.getElementById('noResults').classList.add('hidden');

      // Simulate API call with delay
      setTimeout(() => {
        searchFlights();
      }, 1500);
    });

    function searchFlights() {
      const resultsContainer = document.getElementById('flightResults');
      resultsContainer.innerHTML = '';

      // Randomly select 4-8 flights from database
      const numFlights = Math.floor(Math.random() * 5) + 4;
      const shuffled = [...flightDatabase].sort(() => 0.5 - Math.random());
      const selectedFlights = shuffled.slice(0, numFlights);

      // Hide loading
      document.getElementById('loadingIndicator').classList.add('hidden');

      if (selectedFlights.length === 0) {
        document.getElementById('noResults').classList.remove('hidden');
        return;
      }

      // Show results
      document.getElementById('flightResults').classList.remove('hidden');

      // Check if dark mode is active
      const isDark = document.documentElement.classList.contains('dark');
      const cardBg = isDark ? 'bg-gray-800' : 'bg-white';
      const airlineColor = isDark ? 'text-gray-100' : 'text-gray-900';
      const timeColor = isDark ? 'text-gray-300' : 'text-gray-600';
      const detailColor = isDark ? 'text-gray-400' : 'text-gray-500';

      // Create flight cards
      selectedFlights.forEach(flight => {
        const pricePerPerson = flight.basePrice;
        const totalPrice = pricePerPerson * parseInt(currentSearchData.passengers);
        
        const flightCard = document.createElement('div');
        flightCard.className = `flight-card ${cardBg} p-4 rounded shadow flex flex-col md:flex-row justify-between items-center`;
        flightCard.innerHTML = `
          <div class="flex-1">
            <div class="font-semibold text-lg ${airlineColor}">${flight.airline}</div>
            <div class="text-sm ${timeColor} mt-1">${flight.time}</div>
            <div class="text-sm ${detailColor}">${flight.stops} • ${flight.duration}</div>
          </div>
          <div class="text-right mt-4 md:mt-0">
            <div class="text-2xl font-bold text-indigo-600">₹${totalPrice.toLocaleString('en-IN')}</div>
            <div class="text-xs ${detailColor} mb-2">₹${pricePerPerson.toLocaleString('en-IN')} per person</div>
            <button class="book-btn px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition font-medium" 
                    data-airline="${flight.airline}" 
                    data-time="${flight.time}" 
                    data-price="${totalPrice}"
                    data-base-price="${pricePerPerson}"
                    data-stops="${flight.stops}">Book Now</button>
          </div>
        `;
        resultsContainer.appendChild(flightCard);
      });

      // Attach event listeners to book buttons
      attachBookButtonListeners();

      // Scroll to results
      document.getElementById('flightResults').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function attachBookButtonListeners() {
      document.querySelectorAll('.book-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const button = e.target;
          selectedFlight = {
            airline: button.dataset.airline,
            time: button.dataset.time,
            price: button.dataset.price,
            basePrice: button.dataset.basePrice,
            stops: button.dataset.stops
          };
          openBookingModal();
        });
      });
    }

    function openBookingModal() {
      // Populate modal with flight details
      document.getElementById('modalAirline').textContent = selectedFlight.airline;
      document.getElementById('modalTime').textContent = selectedFlight.time;
      document.getElementById('modalStops').textContent = selectedFlight.stops;
      document.getElementById('modalRoute').textContent = `${currentSearchData.from} → ${currentSearchData.to}`;
      document.getElementById('modalDate').textContent = formatDate(currentSearchData.depart);
      document.getElementById('modalPassengers').textContent = `${currentSearchData.passengers} Passenger${currentSearchData.passengers > 1 ? 's' : ''}`;
      document.getElementById('modalPrice').textContent = `₹${parseInt(selectedFlight.price).toLocaleString('en-IN')}`;

      // Show modal
      const modal = new bootstrap.Modal(document.getElementById('bookingModal'));
      modal.show();

      // Apply appropriate theme to modal
      setTimeout(() => {
        const isDark = document.documentElement.classList.contains('dark');
        const modalContent = document.querySelector('#bookingModal .modal-content');
        if (modalContent) {
          if (isDark) {
            applyDarkModeToModal(modalContent);
          } else {
            applyLightModeToModal(modalContent);
          }
        }
      }, 100);
    }

    function formatDate(dateStr) {
      const date = new Date(dateStr);
      const options = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' };
      return date.toLocaleDateString('en-IN', options);
    }

    // Confirm booking button
    document.getElementById('confirmBookingBtn').addEventListener('click', () => {
      const form = document.getElementById('passengerForm');
      
      // Validate form
      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      // Get form data
      const name = document.getElementById('passengerName').value;
      const email = document.getElementById('passengerEmail').value;
      const phone = document.getElementById('passengerPhone').value;
      const idProof = document.getElementById('passengerID').value;

      // Show loading state on button
      document.getElementById('confirmBtnText').classList.add('hidden');
      document.getElementById('confirmBtnLoader').classList.remove('hidden');
      document.getElementById('confirmBookingBtn').disabled = true;

      // Simulate payment processing
      setTimeout(() => {
        // Hide booking modal
        const bookingModal = bootstrap.Modal.getInstance(document.getElementById('bookingModal'));
        bookingModal.hide();

        // Reset button state
        document.getElementById('confirmBtnText').classList.remove('hidden');
        document.getElementById('confirmBtnLoader').classList.add('hidden');
        document.getElementById('confirmBookingBtn').disabled = false;

        // Generate booking reference
        const bookingRef = 'TRV' + Math.random().toString(36).substr(2, 9).toUpperCase();

        // Show success alert/dialog
        setTimeout(() => {
          showSuccessDialog(bookingRef, name);
          // Apply dark theme to confirmation dialog if needed
          setTimeout(() => {
            const isDark = document.documentElement.classList.contains('dark');
            if (isDark) {
              const confirmModal = document.querySelector('.modal.show .modal-content');
              if (confirmModal) {
                applyDarkModeToConfirmationDialog(confirmModal);
              }
            }
          }, 100);
        }, 300);

        // Reset form
        form.reset();
      }, 2000);
    });

    function showSuccessDialog(bookingRef, passengerName) {
      // Check if dark mode is active
      const isDark = document.documentElement.classList.contains('dark');
      
      // Use inline styles for better compatibility
      const modalBgColor = isDark ? '#1f2937' : '#ffffff';
      const textColorStyle = isDark ? '#f3f4f6' : '#1f2937';
      const textSecondaryStyle = isDark ? '#d1d5db' : '#4b5563';
      const textMutedStyle = isDark ? '#9ca3af' : '#6b7280';
      const cardBgColor = isDark ? '#374151' : '#f9fafb';
      const detailBgColor = isDark ? '#312e81' : '#eef2ff';

      // Create custom success dialog
      const dialog = document.createElement('div');
      dialog.className = 'modal fade';
      dialog.style.display = 'block';
      dialog.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
      dialog.innerHTML = `
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content border-0 shadow-lg" style="background-color: ${modalBgColor};">
            <div class="modal-body text-center p-5">
              <div class="mb-4">
                <div class="mx-auto bg-green-100 rounded-full p-3" style="width: 80px; height: 80px; display: flex; align-items: center; justify-content: center;">
                  <svg class="text-green-600" style="width: 48px; height: 48px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                </div>
              </div>
              <h3 class="text-2xl font-bold mb-3" style="color: ${textColorStyle};">Booking Confirmed! ✈️</h3>
              <p class="mb-4" style="color: ${textSecondaryStyle};">Your flight has been successfully booked.</p>
              <div class="rounded-lg p-4 mb-4" style="background-color: ${detailBgColor};">
                <p class="text-sm mb-1" style="color: ${textSecondaryStyle};">Booking Reference</p>
                <p class="text-2xl font-bold" style="color: #4f46e5;">${bookingRef}</p>
              </div>
              <div class="text-left rounded-lg p-4 mb-4 text-sm" style="background-color: ${cardBgColor};">
                <p class="mb-2" style="color: ${textColorStyle};"><strong>Passenger:</strong> ${passengerName}</p>
                <p class="mb-2" style="color: ${textColorStyle};"><strong>Route:</strong> ${currentSearchData.from} → ${currentSearchData.to}</p>
                <p class="mb-2" style="color: ${textColorStyle};"><strong>Date:</strong> ${formatDate(currentSearchData.depart)}</p>
                <p class="mb-2" style="color: ${textColorStyle};"><strong>Airline:</strong> ${selectedFlight.airline}</p>
                <p style="color: ${textColorStyle};"><strong>Time:</strong> ${selectedFlight.time}</p>
              </div>
              <p class="text-sm mb-4" style="color: ${textMutedStyle};">A confirmation email has been sent to your registered email address with your e-ticket.</p>
              <button onclick="closeSuccessDialog()" class="btn btn-primary px-6 py-2" style="background-color: #4f46e5; border-color: #4f46e5; color: white;">Close</button>
            </div>
          </div>
        </div>
      `;
      document.body.appendChild(dialog);

      // Trigger animation and show modal
      setTimeout(() => {
        dialog.classList.add('show');
      }, 10);

      // Also show browser alert as requested
      alert(`✈️ Booking Successful!\n\nYour booking reference is: ${bookingRef}\n\nThank you for choosing Travelo!`);
    }

    window.closeSuccessDialog = function() {
      const dialogs = document.querySelectorAll('.modal.show');
      dialogs.forEach(dialog => {
        dialog.classList.remove('show');
        setTimeout(() => dialog.remove(), 300);
      });
    };

    function applyLightModeToModal(modalContent) {
      // Ensure modal has light theme styling
      modalContent.classList.remove('bg-gray-800');
      modalContent.classList.add('bg-white');

      // Flight details card - ensure light theme
      const detailsCard = modalContent.querySelector('.bg-gray-700, .bg-indigo-900, .bg-indigo-50');
      if (detailsCard) {
        detailsCard.classList.remove('bg-indigo-900', 'border-indigo-700', 'bg-gray-700', 'border-gray-600');
        detailsCard.classList.add('bg-indigo-50', 'border-indigo-200');
        
        // Update heading in details card
        const heading = detailsCard.querySelector('h6');
        if (heading) {
          heading.classList.remove('text-indigo-100', 'text-gray-100');
          heading.classList.add('text-indigo-900');
        }
        
        // Update all label spans (left side)
        detailsCard.querySelectorAll('.text-indigo-200, .text-gray-300').forEach(span => {
          if (!span.classList.contains('font-medium') && !span.classList.contains('font-bold')) {
            span.classList.remove('text-indigo-200', 'text-gray-300');
            span.classList.add('text-gray-600');
          }
        });
        
        // Update all value spans (right side)
        detailsCard.querySelectorAll('.font-medium').forEach(span => {
          span.classList.remove('text-indigo-100', 'text-gray-100');
        });
        
        // Update bold text (Total Price label)
        detailsCard.querySelectorAll('.font-bold').forEach(span => {
          if (span.classList.contains('text-gray-100')) {
            span.classList.remove('text-gray-100');
            span.classList.add('text-gray-800');
          }
        });
      }

      // Form labels
      modalContent.querySelectorAll('.form-label').forEach(label => {
        label.classList.remove('text-gray-300');
        label.classList.add('text-gray-700');
      });

      // Form headings
      modalContent.querySelectorAll('h6').forEach(h6 => {
        if (!h6.closest('.bg-indigo-50')) {
          h6.classList.remove('text-gray-100');
          h6.classList.add('text-gray-800');
        }
      });

      // Form inputs
      modalContent.querySelectorAll('input').forEach(input => {
        input.classList.remove('bg-gray-700', 'border-gray-600', 'text-gray-100');
        input.style.colorScheme = 'light';
      });

      // Modal footer
      const modalFooter = modalContent.querySelector('.modal-footer');
      if (modalFooter) {
        modalFooter.classList.remove('bg-gray-700');
        modalFooter.classList.add('bg-white');
      }
    }

    function applyDarkModeToModal(modalContent) {
      // Modal background
      modalContent.classList.remove('bg-white');
      modalContent.classList.add('bg-gray-800');

      // Modal header - keep indigo header as is
      const modalHeader = modalContent.querySelector('.modal-header');
      // Header already has bg-indigo-600, no changes needed

      // Flight details card - change to dark theme
      const detailsCard = modalContent.querySelector('.bg-indigo-50');
      if (detailsCard) {
        detailsCard.classList.remove('bg-indigo-50', 'border-indigo-200');
        detailsCard.classList.add('bg-gray-700', 'border-gray-600');
        
        // Update heading in details card
        const heading = detailsCard.querySelector('h6');
        if (heading) {
          heading.classList.remove('text-indigo-900');
          heading.classList.add('text-gray-100');
        }
        
        // Update all label spans (left side) inside details card
        detailsCard.querySelectorAll('.text-gray-600').forEach(span => {
          span.classList.remove('text-gray-600');
          span.classList.add('text-gray-300');
        });
        
        // Update all value spans (right side) - font-medium class
        detailsCard.querySelectorAll('.font-medium').forEach(span => {
          span.classList.add('text-gray-100');
        });
        
        // Update bold text (Total Price label)
        detailsCard.querySelectorAll('.font-bold').forEach(span => {
          if (span.classList.contains('text-gray-800')) {
            span.classList.remove('text-gray-800');
            span.classList.add('text-gray-100');
          }
        });
      }

      // Form section heading
      modalContent.querySelectorAll('h6').forEach(h6 => {
        if (!h6.closest('.bg-indigo-50') && !h6.closest('.bg-gray-700')) {
          h6.classList.add('text-gray-100');
        }
      });

      // Form labels
      modalContent.querySelectorAll('.form-label').forEach(label => {
        label.classList.remove('text-gray-700');
        label.classList.add('text-gray-300');
      });

      // Form inputs
      modalContent.querySelectorAll('input').forEach(input => {
        input.classList.add('bg-gray-700', 'border-gray-600', 'text-gray-100');
        input.style.colorScheme = 'dark';
      });

      // Modal footer
      const modalFooter = modalContent.querySelector('.modal-footer');
      if (modalFooter) {
        modalFooter.classList.remove('bg-white');
        modalFooter.classList.add('bg-gray-700');
      }
    }

    function applyDarkModeToConfirmationDialog(modalContent) {
      // This function is specifically for the success confirmation dialog
      // The dialog HTML already has dynamic classes, but this ensures it's applied
      
      // Double check all text elements
      modalContent.querySelectorAll('h3, p').forEach(el => {
        // Skip if it's already styled correctly
        if (el.classList.contains('text-gray-100') || 
            el.classList.contains('text-gray-300') || 
            el.classList.contains('text-gray-400') ||
            el.classList.contains('text-indigo-600')) {
          return;
        }
        // Add dark text colors
        if (el.tagName === 'H3') {
          el.classList.remove('text-gray-800');
          el.classList.add('text-gray-100');
        } else if (el.classList.contains('text-gray-600')) {
          el.classList.remove('text-gray-600');
          el.classList.add('text-gray-300');
        } else if (el.classList.contains('text-muted') || el.classList.contains('text-gray-500')) {
          el.classList.remove('text-muted', 'text-gray-500');
          el.classList.add('text-gray-400');
        }
      });
    }

    // Initial setup - attach listeners to default flight cards
    attachBookButtonListeners();

    // Set minimum date to today for date inputs
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('departInput').setAttribute('min', today);
    document.getElementById('returnInput').setAttribute('min', today);

    // Monitor theme changes and update page accordingly
    const observer = new MutationObserver((mutations) => {
      mutations.forEach((mutation) => {
        if (mutation.attributeName === 'class') {
          const isDark = document.documentElement.classList.contains('dark');
          updatePageTheme(isDark);
        }
      });
    });

    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ['class']
    });

    // Initial theme check - apply on page load
    const initialIsDark = document.documentElement.classList.contains('dark');
    updatePageTheme(initialIsDark);

    function updatePageTheme(isDark) {
      // Update search form
      const searchForm = document.getElementById('flightSearchForm');
      if (searchForm) {
        if (isDark) {
          searchForm.classList.remove('bg-white');
          searchForm.classList.add('bg-gray-800');
          searchForm.querySelectorAll('input, select').forEach(input => {
            input.classList.add('bg-gray-700', 'border-gray-600', 'text-gray-100');
            input.style.colorScheme = 'dark';
          });
        } else {
          searchForm.classList.remove('bg-gray-800');
          searchForm.classList.add('bg-white');
          searchForm.querySelectorAll('input, select').forEach(input => {
            input.classList.remove('bg-gray-700', 'border-gray-600', 'text-gray-100');
            input.style.colorScheme = 'light';
          });
        }
      }

      // Update existing flight cards
      document.querySelectorAll('.flight-card').forEach(card => {
        if (isDark) {
          card.classList.remove('bg-white');
          card.classList.add('bg-gray-800');
          
          // Update airline names
          card.querySelectorAll('.font-semibold').forEach(el => {
            el.classList.remove('text-gray-900');
            el.classList.add('text-gray-100');
          });
          
          // Update times
          card.querySelectorAll('.text-gray-600').forEach(el => {
            el.classList.remove('text-gray-600');
            el.classList.add('text-gray-300');
          });
          
          // Update details
          card.querySelectorAll('.text-gray-500').forEach(el => {
            el.classList.remove('text-gray-500');
            el.classList.add('text-gray-400');
          });
        } else {
          card.classList.remove('bg-gray-800');
          card.classList.add('bg-white');
          
          // Revert airline names
          card.querySelectorAll('.font-semibold').forEach(el => {
            el.classList.remove('text-gray-100');
            el.classList.add('text-gray-900');
          });
          
          // Revert times
          card.querySelectorAll('.text-gray-300').forEach(el => {
            el.classList.remove('text-gray-300');
            el.classList.add('text-gray-600');
          });
          
          // Revert details
          card.querySelectorAll('.text-gray-400').forEach(el => {
            el.classList.remove('text-gray-400');
            el.classList.add('text-gray-500');
          });
        }
      });

      // Update loading indicator text
      const loadingText = document.querySelector('#loadingIndicator p');
      if (loadingText) {
        if (isDark) {
          loadingText.classList.remove('text-gray-600');
          loadingText.classList.add('text-gray-300');
        } else {
          loadingText.classList.remove('text-gray-300');
          loadingText.classList.add('text-gray-600');
        }
      }

      // Update no results text
      const noResultsTexts = document.querySelectorAll('#noResults p');
      noResultsTexts.forEach(p => {
        if (isDark) {
          if (p.classList.contains('text-gray-600')) {
            p.classList.remove('text-gray-600');
            p.classList.add('text-gray-300');
          }
          if (p.classList.contains('text-gray-500')) {
            p.classList.remove('text-gray-500');
            p.classList.add('text-gray-400');
          }
        } else {
          if (p.classList.contains('text-gray-300')) {
            p.classList.remove('text-gray-300');
            p.classList.add('text-gray-600');
          }
          if (p.classList.contains('text-gray-400')) {
            p.classList.remove('text-gray-400');
            p.classList.add('text-gray-500');
          }
        }
      });
    }
  </script>
</body>

</html>